<% data = [
  ["New customers", Order.group(:id, :buyer_id).count.group_by {|k, v| v > 1}[false].count],
  ["Returning customers",
    if Order.group(:id, :buyer_id).count.group_by {|k, v| v > 1}[true] == nil
      0
    else
     Order.group(:id,:buyer_id).count.group_by {|k, v| v > 1}[true].count
    end
  ]
] %>

<% case locals[:display_type] %>
<% when "pie_chart" %>
  <%= pie_chart data %>
<% when "column_chart" %>
  <%= column_chart data %>
<% else %>
  <%= pie_chart data %>
<% end %>
